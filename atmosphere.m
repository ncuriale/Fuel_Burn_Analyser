function [rho,a,T,P,nu,g] = atmosphere(h)

%1-h~m,2-T~deg C,3-g~m/s2,4-P~N/m2,5-rho~kg/m3,6-mu~Ns/m2
%http://www.engineeringtoolbox.com/standard-atmosphere-d_604.html
% DATA=[-1000	 21.50	9.810	11.39       13.47   	1.821
%         0	 15.00	9.807	10.13       12.25   	1.789
%        1000	  8.50	9.804	8.988       11.12   	1.758
%        2000	  2.00	9.801	7.950       10.07   	1.726
%        3000	 -4.49	9.797	7.012       9.093   	1.694
%        4000	-10.98	9.794	6.166       8.194   	1.661
%        5000	-17.47	9.791	5.405       7.364   	1.628
%        6000	-23.96	9.788	4.722       6.601   	1.595
%        7000	-30.45	9.785	4.111       5.900   	1.561
%        8000	-36.94	9.782	3.565       5.258   	1.527
%        9000	-43.42	9.779	3.080       4.671   	1.493
%       10000	-49.90	9.776	2.650       4.135   	1.458
%       15000	-56.50	9.761	1.211       1.948       1.422
%       20000	-56.50	9.745	0.5529  	0.8891      1.422
%       25000	-51.60	9.730	0.2549  	0.4008      1.448
%       30000	-46.64	9.715	0.1197  	0.1841      1.475
%       40000	-22.80	9.684	0.0287      0.03996 	1.601
%       50000	-25.00	9.654	0.007978	0.01027     1.704
%       60000	-26.13	9.624	0.002196	0.003097	1.584
%       70000	-53.57	9.594	0.00052 	0.0008283	1.438
%       80000	-74.51	9.564	0.00011 	0.0001846	1.321];

%Data taken from online calculator -- http://www.aerospaceweb.org/design/scripts/atmosphere/
DATA=[-1000 	21.501      9.8097	113930	1.347       0.000018206
    -500  	18.2503     9.8082	107480	1.2849      0.00001805
    0       15          9.8067	101330	1.225       0.000017894
    500     11.7503     9.8051	95461	1.1673      0.000017737
    1000	8.501       9.8036	89876	1.1117      0.000017579
    1500	5.2523      9.802	84560	1.0581      0.00001742
    2000	2.0041      9.8005	79501	1.0066      0.00001726
    2500	-1.2436     9.7989	74692	0.95695     0.000017099
    3000	-4.4908     9.7974	70121	0.90925     0.000016938
    3500	-7.7375     9.7959	65780	0.8634      0.000016775
    4000	-10.9836	9.7943	61660	0.81935     0.000016612
    4500	-14.2293	9.7928	57753	0.77704     0.000016448
    5000	-17.4745	9.7912	54048	0.73643     0.000016282
    5500	-20.7191	9.7897	50539	0.69747     0.000016116
    6000	-23.9632	9.7882	47218	0.66011     0.000015949
    6500	-27.2068	9.7866	44075	0.62431     0.000015781
    7000	-30.45      9.7851	41105	0.59002     0.000015612
    7500	-33.6926	9.7836	38300	0.55719     0.000015442
    8000	-36.9346	9.782	35652	0.52579     0.000015271
    8500	-40.1762	9.7805	33154	0.49576 	0.000015099
    9000	-43.4173	9.7789	30801	0.46706     0.000014926
    9500	-46.6579	9.7774	28585	0.43966     0.000014752
    10000	-49.8979	9.7759	26500	0.41351     0.000014577
    10500	-53.1375	9.7743	24540	0.38857     0.0000144
    11000	-56.3765	9.7728	22700	0.3648      0.000014223
    11500	-56.5       9.7713	20985	0.33743     0.000014216
    12000	-56.5       9.7697	19399	0.31194     0.000014216
    12500	-56.5       9.7682	17934	0.28838     0.000014216
    13000	-56.5       9.7667	16580	0.2666      0.000014216
    13500	-56.5       9.7651	15328	0.24646 	0.000014216
    14000	-56.5       9.7636	14170	0.22786 	0.000014216
    14500	-56.5       9.7621	13101	0.21066     0.000014216
    15000	-56.5       9.7605	12112	0.19476     0.000014216
    15500	-56.5       9.759	11198	0.18006     0.000014216
    16000	-56.5       9.7575	10353	0.16647     0.000014216
    16500	-56.5       9.7559	9571.8	0.15391     0.000014216
    17000	-56.5       9.7544	8849.7	0.1423      0.000014216
    17500	-56.5       9.7529	8182.3	0.13157     0.000014216
    18000	-56.5       9.7513	7565.2	0.12165     0.000014216
    18500	-56.5       9.7498	6994.8	0.11247     0.000014216
    19000	-56.5       9.7483	6467.5	0.104       0.000014216
    19500	-56.5       9.7468	5980	0.096157	0.000014216
    20000	-56.5       9.7452	5529.3	0.08891     0.000014216];
  
  %Data matrix dimensions
  imax=23;
  jmax=6;
  gam=1.4;
  
  %height in metres
  z=h*0.3048;
  
  %search for height position in chart
  for i=1:imax
      if (DATA(i,1)<=z && DATA(i+1,1)>z)
          ip=i;
          break;
      end
  end
  
  %Interpolate on chart
  TEMP=zeros(jmax,1);
  for j=1:jmax
      TEMP(j)=interp1(DATA(:,1),DATA(:,j),z,'spline');
      %TEMP(j)=((DATA(ip,j)-DATA(ip+1,j))/(DATA(ip,1)-DATA(ip+1,1)))*(z-DATA(ip+1,1))+DATA(ip+1,j);
  end
  
  %Output quantities
%   rho=TEMP(5)*10^-1;
%   a=sqrt(gam*(TEMP(4)*10^4)/(TEMP(5)*10^-1));
%   T=TEMP(2)+273.15;
%   P=TEMP(4)*10^4;
%   nu=(TEMP(6)*10^-5)/(TEMP(5)*10^-1);
%   g=TEMP(3);
  
  rho=TEMP(5);
  a=sqrt(gam*(TEMP(4))/(TEMP(5)));
  T=TEMP(2)+273.15;
  P=TEMP(4);
  nu=(TEMP(6))/(TEMP(5));
  g=TEMP(3);

end